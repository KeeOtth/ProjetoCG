Preciso modularizar e arrumar essa bagunça ainda, más é um começo, eu acho.